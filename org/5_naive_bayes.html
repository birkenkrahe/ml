<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Understanding Naive Bayes</title>
<meta name="author" content="Marcus Birkenkrahe"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js/dist/theme/black.css" id="theme"/>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide"><h1 class="title">Understanding Naive Bayes</h1><p class="subtitle">Supervised Naive Bayes Prediction</p>
<h2 class="author">Marcus Birkenkrahe</h2><p class="date">Created: 2023-03-13 Mon 23:53</p>
</section>
<section>
<section id="slide-org44582c2">
<h2 id="org44582c2">Na√Øvety of the algorithm</h2>

<div id="org2d1586d" class="figure">
<p><img src="../img/5_candide.png" alt="5_candide.png" width="400px" />
</p>
</div>

<ul>
<li>All features are equally important and independent</li>
<li>Is this justified in real datasets?</li>
<li><p>
Examples: spam / sentiment analysis
</p>

<aside class="notes">
<p>
The question is always what we want to classify: if we're after
spam, some features are more <b>important</b> than others, e.g. the email
sender or the subject line. Words in the message body are not
<b>independent</b> from one another - e.g. "Viagra" will be accompanied by
"drugs", "cash" by "free" etc.
</p>

<p>
If we analyze for sentiment (categories: good, bad, neutral, etc.)
in online reviews, then length of the review is more <b>important</b> than
the (anonymous) sender. The sentiment features are not <b>independent</b>
of the time of the review - it is related to the product launch
time, the time of day, etc.
</p>

<p>
NB performs well even when these assumptions are violated, even if
there are strong feature dependencies, especially with smaller
datasets. The exact reason for this success is not known.
</p>

</aside></li>

</ul>
</section>
</section>
<section>
<section id="slide-org4e529bf">
<h2 id="org4e529bf">Adding more features</h2>

<div id="orgda3f6c2" class="figure">
<p><img src="../img/5_features.png" alt="5_features.png" width="800px" />
</p>
</div>

<p>
Is the message spam given that it contains the terms "Viagra" and
"unsubscribe", but not "Money" or "Groceries"?
</p>


<div id="orgf58eb7f" class="figure">
<p><img src="../img/5_longform.png" alt="5_longform.png" width="800px" />
</p>
</div>

<p>
Cp. "<a href="https://blog.hubspot.com/blog/tabid/6307/bid/30684/the-ultimate-list-of-email-spam-trigger-words.aspx">The Ultimate List of 394 Email Spam Trigger Words to Avoid in
2023</a>"
</p>

<aside class="notes">
<p>
As new messages are received, we need to calculate the posterior
probability to determine whether they are more likely spam or ham,
given the likelihood of the words being found in the message text.
</p>

<p>
Computational complexity is enormous: probabilities for possible
intersecting events need to be stored. Imagine the Venn diagram of
four overlapping circles - in reality, we have hundreds of features.
</p>

</aside>

</section>
</section>
<section>
<section id="slide-org8df2634">
<h2 id="org8df2634">Core assumptions</h2>
<ul>
<li>Class-conditional independence</li>
<li>Constant marginal likelihood</li>

</ul>

<div id="org2f94d84" class="figure">
<p><img src="../img/5_spamshort.png" alt="5_spamshort.png" width="800px" />
</p>
</div>

<div id="org3b85503" class="figure">
<p><img src="../img/5_hamshort.png" alt="5_hamshort.png" width="800px" />
</p>
</div>

<aside class="notes">
<ul>
<li>Events are <b>independent</b> as long as they are conditioned on the same
class value: for example, "Money" and "Unsubscribe" are considered
independent when found in a spam message. Reduces the numerator term
to a product of probabilities.</li>
<li>Denominator does not depend on the target class (spam or ham) and is
treated as <b>constant</b> and can be ignored.</li>
<li>The equation has become a proportion</li>
<li>To convert the likelihoods to probabilities, the denominator needs
to be re-introduced (rescale likelihood of each outcome by total
likelihood across all possible outcomes).</li>

</ul>

</aside>
</section>
</section>
<section>
<section id="slide-org6f9fe42">
<h2 id="org6f9fe42">Formula</h2>

<div id="org8786d29" class="figure">
<p><img src="../img/5_formula.png" alt="5_formula.png" width="600px" />
</p>
</div>

<ul>
<li>Class levels \(L\) (e.g. spam vs. ham)</li>
<li>Features \(F\) (e.g. "Money", "Urgent")</li>
<li>Scaling factor \(Z\)</li>

</ul>

<aside class="notes">
<p>
Z converts the likelihood values to probabilities.
</p>

</aside>

</section>
</section>
<section>
<section id="slide-orgd720836">
<h2 id="orgd720836">Workflow</h2>

<div id="org96e2157" class="figure">
<p><img src="../img/5_Spamfilter.jpg" alt="5_Spamfilter.jpg" width="300px" />
</p>
</div>

<ol>
<li>compute frequency table</li>
<li>compute likelihood table</li>
<li>multiply probabilities "naively"</li>
<li>rescale likelihood to probability</li>

</ol>

<aside class="notes">
<p>
Process:
</p>
<ol>
<li>frequency table,</li>
<li>likelihood table,</li>
<li>multiply conditional probabilities with "naive" assumption of independence,</li>
<li>divide by total likelihood to transform each class likelihood to a
probability.</li>

</ol>

</aside>
</section>
</section>
<section>
<section id="slide-org2ccc3da">
<h2 id="org2ccc3da">Laplace correction</h2>
</section>
</section>
<section>
<section id="slide-org2ef7352">
<h2 id="org2ef7352">Numeric features</h2>
</section>
</section>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/reveal.js/dist/reveal.js"></script>
<script src="https://cdn.jsdelivr.net/npm/reveal.js/plugin/markdown/markdown.js"></script>
<script src="https://cdn.jsdelivr.net/npm/reveal.js/plugin/zoom/zoom.js"></script>
<script src="https://cdn.jsdelivr.net/npm/reveal.js/plugin/notes/notes.js"></script>


<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({
plugins: [RevealMarkdown, RevealZoom, RevealNotes],
transition: 'cube'
});

</script>
</body>
</html>
